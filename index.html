<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNSS Dashboard UKF Fusion üõ∞Ô∏è</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20n6a9c4Qk+Jj37+V/vYdJz5A9Z8oN9L8c3S0D9n6bWw=" crossorigin=""></script>

    <style>
        /* CSS de Base pour le Dashboard */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            background-color: #f4f7f9; 
            color: #333;
            transition: background-color 0.3s, color 0.3s;
        }
        .dashboard-container { 
            display: grid; 
            grid-template-columns: 1fr 2fr; 
            gap: 20px; 
            padding: 20px; 
            max-width: 1400px; 
            margin: 0 auto;
        }
        .panel { 
            background-color: #fff; 
            padding: 15px; 
            border-radius: 8px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            margin-bottom: 20px;
        }
        h2 { 
            border-bottom: 2px solid #007bff; 
            padding-bottom: 5px; 
            margin-top: 0; 
            color: #007bff;
            font-size: 1.2em;
        }
        .data-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 10px; 
        }
        .data-item { 
            display: flex; 
            justify-content: space-between; 
            padding: 5px 0; 
            border-bottom: 1px dashed #eee;
        }
        .label { 
            font-weight: 600; 
        }
        .value { 
            color: #28a745; 
            font-family: monospace;
        }
        #map { 
            height: 400px; 
            border-radius: 8px; 
            margin-bottom: 20px;
        }
        .control-panel button, .control-panel select, .control-panel input {
            padding: 8px 12px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #emergency-stop-btn.active {
            background-color: #dc3545;
            color: white;
        }
        /* Dark Mode */
        .dark-mode {
            background-color: #1a1a2e;
            color: #e0e0e0;
        }
        .dark-mode .panel {
            background-color: #1f4068;
            box-shadow: 0 4px 6px rgba(0,0,0,0.5);
        }
        .dark-mode h2 {
            border-bottom-color: #46cdcf;
            color: #46cdcf;
        }
        .dark-mode .value {
            color: #90ee90;
        }
        .dark-mode .data-item {
            border-bottom-color: #3e5c76;
        }
    </style>
</head>
<body class="light-mode">

    <header style="background-color: #007bff; color: white; padding: 10px 20px;">
        <h1>Syst√®me de Navigation Avanc√© GNSS-UKF</h1>
    </header>

    <div class="dashboard-container">
        <div>
            <div class="panel control-panel">
                <h2>Contr√¥les Syst√®me</h2>
                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                    <button id="toggle-gps-btn">‚ñ∂Ô∏è MARCHE GPS</button>
                    <button id="emergency-stop-btn">üõë Arr√™t d'urgence: INACTIF üü¢</button>
                    <button id="nether-toggle-btn">Toggle Nether</button>
                    <button id="toggle-mode-btn">Mode Clair/Sombre</button>
                    
                    <label for="freq-select">Fr√©quence GPS:</label>
                    <select id="freq-select" onchange="setGPSMode(this.value)">
                        <option value="HIGH_FREQ" selected>Haute (1Hz+)</option>
                        <option value="LOW_FREQ">Basse (2min)</option>
                    </select>

                    <label for="mass-input">Masse (kg):</label>
                    <input type="number" id="mass-input" value="70.0" step="0.1" min="0.1">
                </div>
            </div>

            <div class="panel">
                <h2>Vitesse & Performance</h2>
                <div class="data-grid">
                    <div class="data-item"><span class="label">Vitesse Stable (km/h)</span><span class="value" id="speed-stable">0.00000</span></div>
                    <div class="data-item"><span class="label">Vitesse Stable (m/s)</span><span class="value" id="speed-stable-ms">0.000 m/s</span></div>
                    <div class="data-item"><span class="label">Vitesse 3D (Brute km/h)</span><span class="value" id="speed-3d-inst">0.00000</span></div>
                    <div class="data-item"><span class="label">Vitesse Max (km/h)</span><span class="value" id="speed-max">0.00000</span></div>
                    <div class="data-item"><span class="label">Vitesse Moy. (Mouv.)</span><span class="value" id="speed-avg-moving">0.00000 km/h</span></div>
                    <div class="data-item"><span class="label">TAS (Airspeed m/s)</span><span class="value" id="tas-display">0.000 m/s</span></div>
                    <div class="data-item"><span class="label">% Vitesse du Son</span><span class="value" id="perc-speed-sound">0.00 %</span></div>
                    <div class="data-item"><span class="label">% Vitesse Lumi√®re (c)</span><span class="value" id="perc-speed-c">0.00e-9 %</span></div>
                </div>
            </div>

            <div class="panel">
                <h2>Distance & Temps</h2>
                <div class="data-grid">
                    <div class="data-item"><span class="label">Distance Totale</span><span class="value" id="distance-total-km">0.000 km | 0.00 m</span></div>
                    <div class="data-item"><span class="label">Temps √âcoul√©</span><span class="value" id="time-elapsed">0.00 s</span></div>
                    <div class="data-item"><span class="label">Temps en Mouvement</span><span class="value" id="time-moving">0.00 s</span></div>
                    <div class="data-item"><span class="label">Temps Lumi√®re (s/min/h)</span><span class="value">
                        <span id="distance-light-s">0.00e-9 s</span> | 
                        <span id="distance-light-min">0.00e-11 min</span> | 
                        <span id="distance-light-h">0.00e-13 h</span>
                    </span></div>
                    <div class="data-item"><span class="label">Distance Cosmique (UA/al)</span><span class="value" id="distance-cosmic">0.00e-9 UA | 0.00e-14 al</span></div>
                    <div class="data-item"><span class="label">Date/Heure Locale</span><span class="value"><span id="date-display">N/A</span> / <span id="local-time">N/A</span></span></div>
                </div>
                <div class="control-panel" style="margin-top: 10px;">
                    <button id="reset-dist-btn">R√©init. Distance</button>
                    <button id="reset-max-btn">R√©init. Max Vitesse</button>
                    <button id="reset-all-btn">R√©init. Session</button>
                </div>
            </div>
        </div>

        <div>
            <div id="map"></div>
            
            <div class="panel">
                <h2>GPS & Altitude (Fusion UKF)</h2>
                <div class="data-grid">
                    <div class="data-item"><span class="label">Latitude</span><span class="value" id="latitude">N/A</span></div>
                    <div class="data-item"><span class="label">Longitude</span><span class="value" id="longitude">N/A</span></div>
                    <div class="data-item"><span class="label">Altitude (UKF/Baro)</span><span class="value" id="altitude-gps">N/A</span></div>
                    <div class="data-item"><span class="label">Pr√©cision (GPS/Forc√©e)</span><span class="value" id="gps-precision">N/A</span></div>
                    <div class="data-item"><span class="label">Vitesse Verticale</span><span class="value" id="vertical-speed">0.00 m/s</span></div>
                    <div class="data-item"><span class="label">Cap (Heading)</span><span class="value" id="heading-display">N/A</span></div>
                </div>
                <p style="margin-top: 10px; font-style: italic; color: #555;"><span id="underground-status">Souterrain: Non (N/A)</span></p>
            </div>
            
            <div class="panel">
                <h2>Dynamique & √âtat Filtres</h2>
                <div class="data-grid">
                    <div class="data-item"><span class="label">Acc√©l√©ration Longitudinale</span><span class="value" id="accel-long">0.000 m/s¬≤</span></div>
                    <div class="data-item"><span class="label">Force G Longitudinale</span><span class="value" id="force-g-long">0.00 G</span></div>
                    <div class="data-item"><span class="label">Gravit√© Locale</span><span class="value" id="gravity-local">9.80665 m/s¬≤</span></div>
                    <div class="data-item"><span class="label">Incertitude UKF Vit. (P)</span><span class="value" id="kalman-uncert">1000.000 m¬≤/s¬≤</span></div>
                    <div class="data-item"><span class="label">Incertitude UKF Alt. (P)</span><span class="value" id="ukf-uncert-alt">10.000 m¬≤</span></div>
                    <div class="data-item"><span class="label">Bruit de Mesure (R dyn)</span><span class="value" id="speed-error-perc">500.000 m¬≤</span></div>
                    <div class="data-item"><span class="label">√ânergie Cin√©tique</span><span class="value" id="kinetic-energy">0.00 J</span></div>
                    <div class="data-item"><span class="label">Puissance M√©canique</span><span class="value" id="mechanical-power">0.00 W</span></div>
                    <div class="data-item"><span class="label">Force de Coriolis</span><span class="value" id="coriolis-force">0.00e-9 N</span></div>
                </div>
            </div>

            <div class="panel">
                <h2>IMU & Attitude (Quaternion)</h2>
                <p>Statut IMU: <span id="imu-status">Inactif</span></p>
                <div class="data-grid">
                    <div class="data-item"><span class="label">Accel X</span><span class="value" id="imu-accel-x">0.00 m/s¬≤</span></div>
                    <div class="data-item"><span class="label">Accel Y</span><span class="value" id="imu-accel-y">0.00 m/s¬≤</span></div>
                    <div class="data-item"><span class="label">Accel Z</span><span class="value" id="imu-accel-z">0.00 m/s¬≤</span></div>
                    <div class="data-item"><span class="label">Attitude (Roll)</span><span class="value" id="attitude-roll">0.00 ¬∞</span></div>
                    <div class="data-item"><span class="label">Attitude (Pitch)</span><span class="value" id="attitude-pitch">0.00 ¬∞</span></div>
                    <div class="data-item"><span class="label">Attitude (Yaw)</span><span class="value" id="attitude-yaw">0.00 ¬∞</span></div>
                </div>
            </div>

            <div class="panel">
                <h2>M√©t√©o & Configuration</h2>
                <div class="data-grid">
                    <div class="data-item"><span class="label">Temp√©rature Air</span><span class="value" id="temp-air-2">N/A</span></div>
                    <div class="data-item"><span class="label">Pression Atm.</span><span class="value" id="pressure-2">N/A</span></div>
                    <div class="data-item"><span class="label">Humidit√©</span><span class="value" id="humidity-2">N/A</span></div>
                    <div class="data-item"><span class="label">Densit√© Air</span><span class="value" id="air-density">N/A</span></div>
                    <div class="data-item"><span class="label">Point de Ros√©e</span><span class="value" id="dew-point">N/A</span></div>
                    <div class="data-item"><span class="label">Masse Totale</span><span class="value" id="mass-display">70.000 kg</span></div>
                    
                    <div class="data-item"><span class="label">Corps C√©leste</span>
                        <select id="celestial-body-select">
                            <option value="EARTH" selected>Terre (WGS84)</option>
                            <option value="MARS">Mars</option>
                            <option value="MOON">Lune</option>
                            <option value="ROTATING">Corps en Rotation</option>
                        </select>
                    </div>
                    <div class="data-item"><span class="label">Gravit√© de Base</span><span class="value" id="gravity-base">9.80665 m/s¬≤</span></div>
                    
                    <div class="data-item"><span class="label">Environnement (R)</span>
                        <select id="environment-select">
                            <option value="NORMAL" selected>Normal</option>
                            <option value="CITY">Urbain (x2)</option>
                            <option value="TUNNEL">Souterrain (x5)</option>
                            <option value="FLIGHT">Vol (x0.5)</option>
                        </select>
                    </div>
                    <div class="data-item"><span class="label">Facteur Environnement</span><span class="value" id="env-factor">NORMAL (x1.0)</span></div>
                    <div class="data-item"><span class="label">Mode Nether (Ratio)</span><span class="value" id="mode-nether">D√âSACTIV√â (1:1)</span></div>
                    <div class="data-item"><span class="label">Override Pr√©cision (m)</span>
                        <input type="number" id="gps-accuracy-override" value="0.0" step="0.1" min="0" style="width: 80px;">
                    </div>

                    <div class="data-item"><span class="label">Rayon de Rotation (m)</span>
                        <input type="number" id="rotation-radius" value="100" step="1" min="1" style="width: 80px;">
                    </div>
                    <div class="data-item"><span class="label">Vitesse Angulaire (rad/s)</span>
                        <input type="number" id="angular-velocity" value="0.0" step="0.1" style="width: 80px;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="gnss-dashboard-full.js"></script>

</body>
                        </html>
