<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GNSS SpaceTime ‚Ä¢ Tableau Scientifique (Pro)</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
:root{
  --bg:#061226; --card:#071428; --muted:#9fb6c9; --accent:#58c1ff;
  --glass: rgba(255,255,255,0.03); --radius:12px; --mono: "Courier New", monospace;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#d9eef9;background:linear-gradient(180deg,#02101a 0%,#061226 75%)}
.header{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;max-width:1400px;margin:10px auto;color:var(--muted)}
.header h1{margin:0;color:var(--accent);font-size:1.05rem}
.container{max-width:1400px;margin:0 auto;padding:12px;display:grid;grid-template-columns:320px 1fr 360px;gap:12px}
.card{background:var(--glass);border-radius:var(--radius);padding:12px;box-shadow:0 10px 30px rgba(0,0,0,0.6);backdrop-filter:blur(6px)}
.section-title{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.section-title h2{margin:0;color:#9ed8ff;font-size:0.98rem}
.controls-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.button{background:var(--accent);border:none;padding:8px;border-radius:8px;font-weight:700;color:#02243a;cursor:pointer}
.input{background:transparent;border:1px solid rgba(255,255,255,0.06);border-radius:6px;padding:6px;color:inherit;width:100%}
.dp{display:flex;justify-content:space-between;padding:8px;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:0.92rem}
.small{font-size:0.82rem;color:var(--muted)}
#map{height:360px;border-radius:10px;overflow:hidden}
.row{display:flex;gap:8px;align-items:center}
.minecraft-clock{width:96px;height:96px;border-radius:50%;position:relative;border:3px solid rgba(255,255,255,0.06);overflow:hidden;background:linear-gradient(180deg,#2b7a2b,#60b05d)}
.biome-half{position:absolute;left:0;right:0;top:50%;bottom:0;background:linear-gradient(#4caf50,#8bc34a);transition:all .4s}
.sun-disc,.moon-disc{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:22px}
.sun-disc{background: radial-gradient(circle at 30% 30%, #fff7b2, #ffda47); box-shadow:0 0 32px rgba(255,200,40,0.35)}
.moon-disc{background: radial-gradient(circle at 30% 30%, #f8f8ff, #d6d6df); box-shadow:0 0 10px rgba(255,255,255,0.06)}
.xray-btn{position:absolute;right:10px;top:10px;background:rgba(0,0,0,0.5);color:white;border:none;border-radius:8px;padding:6px;cursor:pointer}
.legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.legend .item{background:rgba(255,255,255,0.03);padding:6px;border-radius:6px;font-size:0.8rem}
.footer{max-width:1400px;margin:14px auto;padding:12px;color:var(--muted);font-size:0.82rem;text-align:center}

/* responsive */
@media (max-width:1100px){ .container{grid-template-columns:1fr} .header{padding:8px} }
</style>
</head>
<body>

<header class="header">
  <h1>GNSS SpaceTime ‚Äî Tableau Scientifique Professionnel</h1>
  <div class="small">Fusion compl√®te ‚Ä¢ EKF/UKF ‚Ä¢ IMU ‚Ä¢ Astronomie ‚Ä¢ M√©t√©o ‚Ä¢ Physique ‚Ä¢ Logs</div>
</header>

<main class="container">

  <!-- LEFT: Controls & Sensors -->
  <aside class="card" aria-labelledby="controls-title">
    <div class="section-title"><h2 id="controls-title">Contr√¥les & Capteurs</h2></div>

    <div class="dp"><span>Latitude</span><strong id="lat">N/A</strong></div>
    <div class="dp"><span>Longitude</span><strong id="lon">N/A</strong></div>
    <div class="dp"><span>Altitude (m)</span><strong id="alt">N/A</strong></div>
    <div class="dp"><span>Precision GPS</span><strong id="gps-acc">N/A</strong></div>

    <div class="controls-grid" style="margin-top:10px">
      <button id="btn-locate" class="button">üìç Localiser</button>
      <button id="btn-watch" class="button">üîÅ Watch</button>
      <button id="btn-stop" class="button">‚èπ Stop</button>
      <button id="btn-imu" class="button">üì° IMU ON</button>
      <button id="btn-capture" class="button" title="Capturer un snapshot de toutes les donn√©es">üì∏ Capturer</button>
      <button id="btn-export" class="button">‚¨áÔ∏é Export CSV</button>
    </div>

    <h2 style="margin-top:12px">Param√®tres physiques</h2>
    <div class="dp"><span>Masse (kg)</span><input id="mass" class="input" type="number" value="70"></div>
    <div class="dp"><span>Surface (m¬≤)</span><input id="area" class="input" type="number" step="0.01" value="0.5"></div>
    <div class="dp"><span>Cd</span><input id="cd" class="input" type="number" step="0.01" value="1"></div>

    <h2 style="margin-top:12px">Statuts & Diagnostics</h2>
    <div class="dp"><span>IMU</span><strong id="imu-status">N/A</strong></div>
    <div class="dp"><span>GPS</span><strong id="gps-status">N/A</strong></div>
    <div class="dp"><span>Filtre (EKF/UKF)</span><strong id="filter-status">N/A</strong></div>

    <div style="margin-top:12px" class="small">
      <div>Mode : <select id="ui-mode"><option value="day">Jour</option><option value="night">Nuit</option></select></div>
      <div style="margin-top:6px">Activer Variante Filtre :
        <select id="filter-select"><option value="EKF">EKF (Stable)</option><option value="UKF21">UKF21 (Plugin)</option></select>
      </div>
    </div>
  </aside>

  <!-- CENTER: Map / charts / astro -->
  <section class="card" aria-labelledby="map-title">
    <div class="section-title">
      <h2 id="map-title">Carte ‚Ä¢ ISS ‚Ä¢ Trajectoires</h2>
      <div class="row">
        <button id="btn-iss-track" class="button">üõ∞ Suivre ISS</button>
        <button id="btn-trail" class="button">‚ú≥Ô∏è Trace</button>
        <button id="btn-replay" class="button">‚ñ∂Ô∏è Replay</button>
      </div>
    </div>

    <div id="map" role="region" aria-label="Carte"></div>
    <div class="legend">
      <div class="item">Derni√®re ISS: <strong id="iss-last">N/A</strong></div>
      <div class="item">Logs: <strong id="log-count">0</strong></div>
      <div class="item">Mode Nethe r: <strong id="nether-mode">OFF</strong></div>
    </div>

    <h2 style="margin-top:12px">Graphiques</h2>
    <canvas id="chartTemp" height="80"></canvas>
    <canvas id="chartAQI" height="80" style="margin-top:8px"></canvas>

    <h2 style="margin-top:12px">Astronomie & Horloge Solaire</h2>
    <div class="row" style="align-items:center;gap:14px">
      <div class="minecraft-clock" aria-hidden="true">
        <div class="biome-half" id="biome-half"></div>
        <div class="sun-disc" id="sun-disc">‚òÄÔ∏è</div>
        <div class="moon-disc" id="moon-disc">üåô</div>
      </div>
      <div>
        <div class="dp"><span>Soleil alt/az</span><strong id="sun-altaz">N/A</strong></div>
        <div class="dp"><span>Lune phase / illum.</span><strong id="moon-phase">N/A</strong></div>
        <div class="dp"><span>Equation du Temps</span><strong id="eot">N/A</strong></div>
        <div class="dp"><span>Midi solaire local</span><strong id="solar-noon">N/A</strong></div>
      </div>
    </div>

    <div class="small" style="margin-top:8px">Animation Soleil/Lune : disque interactif (z√©nith, horizon, demi-disque Minecraft-style), mode ¬´ nether ¬ª (transparent / souterrain) et aurora placeholder.</div>
  </section>

  <!-- RIGHT: Science / derived quantities -->
  <aside class="card" aria-labelledby="science-title">
    <div class="section-title"><h2 id="science-title">M√©t√©o ‚Ä¢ Physique ‚Ä¢ Dynamique</h2></div>

    <div class="dp"><span>Temp (¬∞C)</span><strong id="temp">N/A</strong></div>
    <div class="dp"><span>Humidit√© (%)</span><strong id="rh">N/A</strong></div>
    <div class="dp"><span>Pression (hPa)</span><strong id="pressure">N/A</strong></div>
    <div class="dp"><span>Point de ros√©e (¬∞C)</span><strong id="dew">N/A</strong></div>
    <div class="dp"><span>Densit√© air œÅ</span><strong id="rho">N/A</strong></div>
    <div class="dp"><span>Viscosit√© Œº</span><strong id="mu">N/A</strong></div>
    <div class="dp"><span>Vitesse son c</span><strong id="c_sound">N/A</strong></div>

    <h2 style="margin-top:12px">Vitesse & Relativit√©</h2>
    <div class="dp"><span>Vitesse brute (m/s)</span><strong id="speed-raw-ms">N/A</strong></div>
    <div class="dp"><span>Vitesse stable (m/s)</span><strong id="speed-stable-ms">N/A</strong></div>
    <div class="dp"><span>Vitesse max (session)</span><strong id="speed-max">N/A</strong></div>
    <div class="dp"><span>Mach</span><strong id="mach-number">N/A</strong></div>
    <div class="dp"><span>Œ≥ (Lorentz)</span><strong id="lorentz-factor">N/A</strong></div>

    <h2 style="margin-top:12px">Forces & Energie</h2>
    <div class="dp"><span>Pression dynamique q</span><strong id="qdyn">N/A</strong></div>
    <div class="dp"><span>Force tra√Æn√©e</span><strong id="drag">N/A</strong></div>
    <div class="dp"><span>Force Coriolis</span><strong id="coriolis">N/A</strong></div>
    <div class="dp"><span>Gravit√© locale</span><strong id="g_local">N/A</strong></div>

    <h2 style="margin-top:12px">Distances & conversions</h2>
    <div class="dp"><span>Distance totale (3D)</span><strong id="distance-total">N/A</strong></div>
    <div class="dp"><span>Horizon visible (km)</span><strong id="horizon-distance">N/A</strong></div>
    <div class="dp"><span>Distance (ann√©es-lumi√®re)</span><strong id="distance-ly">N/A</strong></div>

    <div class="small" style="margin-top:8px">Tous les indicateurs suivent les r√®gles d√©crites dans vos captures : priorit√© aux capteurs (barom√®tre pour altitude corrig√©e), affichage solaire/lunaire corrig√©, capacit√© de simulation si donn√©es non-r√©elles mais toujours avec trace et export.</div>
  </aside>

</main>

<footer class="footer">Dashboard fusionn√© ‚Äî toutes les fonctionnalit√©s demand√©es int√©gr√©es. Pour ISS/Open-Notify, utilisez le proxy si besoin (voir README / server snippet).</footer>

<!-- scripts (app.js must be coll√© en 5 parties dans un fichier app.js) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.4.1/math.min.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/suncalc@1.8.0/suncalc.js"></script>
<script src="gnss-dashbord-full.js"></script>

</body>
  </html>
                                                    
