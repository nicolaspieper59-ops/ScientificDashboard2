<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNSS SpaceTime Dashboard ‚Ä¢ EKF 21-√âtats & Globe 3D</title>
    
    <script src="https://unpkg.com/suncalc@1.9.0/suncalc.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script> 
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />
          
    <style>
        /* --- Styles du Dashboard (Utilisez vos propres styles si diff√©rents) --- */
        :root {
            --bg-light: #f4f7f6;
            --bg-dark: #121220;
            --panel-light: #ffffff;
            --panel-dark: #1e1e1e;
            --text-light: #333;
            --text-dark: #f0f0f0;
            --accent-color: #007bff;
        }

        body { 
            font-family: 'Consolas', monospace; 
            margin: 0; 
            padding: 0; 
            background-color: var(--bg-light); 
            color: var(--text-light); 
            transition: background-color 0.8s, color 0.8s; 
        }

        body.dark-mode {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }
        
        body.dark-mode .dashboard-container,
        body.dark-mode .section {
            background-color: var(--panel-dark);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            border-color: #333;
        }
        
        .dashboard-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            padding: 15px;
            max-width: 1600px;
            margin: 20px auto;
            background-color: var(--panel-light);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            border: 1px solid #ccc;
        }
        
        .section {
            background-color: var(--panel-light);
            padding: 15px;
            border-radius: 8px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.05);
            border: 1px solid #eee;
        }
        
        .section h2, .section h3 {
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 5px;
            margin-top: 0;
            font-size: 1.1em;
            text-transform: uppercase;
        }

        .data-point {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 0.9em;
        }

        .data-point span:last-child {
            font-weight: bold;
        }

        /* Globe 3D */
        #globe-3d-container {
            height: 300px;
            width: 100%;
            border-radius: 8px;
            margin-top: 10px;
            background-color: transparent; 
            overflow: hidden;
            border: 1px solid #444; /* Bordure pour le visualiser */
        }
        
        /* Ajustements de grille */
        .grid-span-4 { grid-column: span 4; }
        
        .control-input-full { padding: 5px 0; }
        .control-input-full label { font-size: 0.9em; display: block; margin-bottom: 3px; }
        .control-input-full input, .control-input-full select { width: 100%; box-sizing: border-box; }
        button { width: 100%; padding: 8px; margin-top: 5px; border-radius: 4px; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="dashboard-container">

        <div class="section controls">
            <h2><i class="fas fa-sliders-h"></i> Contr√¥les & Syst√®me</h2>
            <div class="data-point"><span>Heure Locale (NTP)</span><span id="local-time">SYNCHRO EN COURS...</span></div>
            <div class="data-point"><span>Date Locale (UTC)</span><span id="date-display">N/A</span></div>
            <div class="data-point"><span>Temps √©coul√© (Session)</span><span id="time-elapsed">0.00 s</span></div>
            <div class="data-point"><span>Temps de Mouvement</span><span id="time-moving">0.00 s</span></div>
            <button id="toggle-gps-btn">‚ñ∂Ô∏è D√©marrer la Fusion (INS/GNSS)</button>
            <button id="emergency-stop-btn">üõë Arr√™t d'urgence: INACTIF üü¢</button>

            <hr>
            
            <h3>Options EKF</h3>
            <div class="control-input-full">
                <label for="environment-select">Environnement (Filtre Kalman)</label>
                <select id="environment-select">
                    <option value="NORMAL">Normal</option>
                    <option value="FOREST">For√™t</option>
                    <option value="CONCRETE">Grotte/Tunnel</option>
                    <option value="METAL">M√©tal/B√¢timent</option>
                </select>
                <span id="env-factor">Normal (x1.0)</span>
            </div>
            <div class="control-input-full">
                <label for="mass-input">Masse de l'objet (kg)</label>
                <input type="number" id="mass-input" value="70" step="1" min="0">
                <span id="mass-display">70.000 kg</span>
            </div>
            <div class="control-input-full">
                <label for="celestial-body-select">Corps C√©leste (Gravit√©)</label>
                <select id="celestial-body-select">
                    <option value="EARTH">Terre</option>
                    <option value="MOON">Lune</option>
                </select>
                <span id="gravity-base">9.8067 m/s¬≤</span>
            </div>
            <button id="set-target-btn">Placer Cible sur Globe</button>
            <hr>
            
            <h2><i class="fas fa-location-arrow"></i> Position & Attitude</h2>
            <div class="data-point"><span>Latitude (EKF)</span><span id="latitude">N/A</span></div>
            <div class="data-point"><span>Longitude (EKF)</span><span id="longitude">N/A</span></div>
            <div class="data-point"><span>Altitude Corrig√©e (MSL)</span><span id="altitude-amsl">N/A</span></div>
            <div class="data-point"><span>Cap (Yaw)</span><span id="heading-display">N/A</span></div>
            <div class="data-point"><span>Roll / Pitch</span><span id="roll-pitch-display">0.00¬∞ / 0.00¬∞</span></div>
        </div>

        <div class="section">
            <h2><i class="fas fa-tachometer-alt"></i> Vitesse & Distance (3D)</h2>
            <div class="data-point"><span>Vitesse EKF 3D (km/h)</span><span id="speed-stable-3d-kmh">--.- km/h</span></div>
            <div class="data-point"><span>Vitesse EKF 3D (m/s)</span><span id="speed-stable-3d-ms">-- m/s</span></div>
            <div class="data-point"><span>Vitesse Max 3D (Session)</span><span id="speed-max-3d">0.0 km/h</span></div>
            <div class="data-point"><span>Distance Totale (3D)</span><span id="distance-total-km">0.000 km | 0.00 m</span></div>

            <hr>
            
            <h3>Acoustique & Relativit√©</h3>
            <div class="data-point"><span>Vitesse du Son (m/s)</span><span id="speed-sound-local">N/A</span></div>
            <div class="data-point"><span>Nombre de Mach</span><span id="mach-number">0.0000</span></div>
            <div class="data-point"><span>% Vitesse Lumi√®re (c)</span><span id="perc-speed-c">0.00e+0 %</span></div>
            <div class="data-point"><span>Facteur de Lorentz (Œ≥)</span><span id="lorentz-factor">1.0000</span></div>
            
            <hr>
            
            <h2><i class="fas fa-cube"></i> Dynamique & Forces</h2>
            <div class="data-point"><span>Gravit√© Locale (g)</span><span id="gravity-local">N/A</span></div>
            <div class="data-point"><span>Force G (Acc. Long.)</span><span id="force-g-long">0.00 G</span></div>
            <div class="data-point"><span>Force de Tra√Æn√©e</span><span id="drag-force">0.00 N</span></div>
            <div class="data-point"><span>Force de Coriolis</span><span id="coriolis-force">0.00 N</span></div>
            <div class="data-point"><span>Pression Dynamique (q)</span><span id="dynamic-pressure">0.00 Pa</span></div>
        </div>

        <div class="section">
            <h2><i class="fas fa-globe"></i> Globe Interactif 3D & EKF</h2>
            <div class="data-point"><span>Pr√©cision GPS (Acc)</span><span id="gps-precision">N/A</span></div>
            <div class="data-point"><span>Erreur DR/EKF (m)</span><span id="dead-reckoning-error">0.0 m</span></div>
            
            <div id="globe-3d-container">
                Chargement du Globe Interactif 3D... (N√©cessite WebGL)
            </div>
            
            <div class="data-point"><span>Biome Actuel (√âcholocalisation)</span><span id="current-biome">N/A</span></div>
            
            <hr>
            
            <h2><i class="fas fa-brain"></i> Filtre EKF & Debug</h2>
            <div class="data-point"><span>Statut GPS & EKF</span><span id="gps-status-dr">Arr√™t√©</span></div>
            <div class="data-point"><span>Incertitude Vitesse (P)</span><span id="kalman-uncert">N/A</span></div>
            <div class="data-point"><span>Incertitude Alt. (œÉ)</span><span id="alt-uncertainty">N/A</span></div> 
            <div class="data-point"><span>Bruit Mesure Vitesse (R)</span><span id="speed-error-perc">N/A</span></div>
        </div>

        <div class="section">
            <h2><i class="fas fa-flask"></i> M√©t√©o & Chimie</h2>
            <div class="data-point"><span>Temp. Air</span><span id="temp-air-2">N/A</span></div>
            <div class="data-point"><span>Pression Atm.</span><span id="pressure-2">N/A</span></div>
            <div class="data-point"><span>Humidit√© Relative</span><span id="humidity-2">N/A</span></div>
            <div class="data-point"><span>Point de Ros√©e</span><span id="dew-point">N/A</span></div>
            <div class="data-point"><span>Densit√© de l'Air</span><span id="air-density">N/A</span></div>
            <div class="data-point"><span>Taux d'Oxyg√®ne (O‚ÇÇ)</span><span id="o2-level">20.9 % vol</span></div>
            <div class="data-point"><span>Taux de CO‚ÇÇ (ppm)</span><span id="co2-level">N/A (Capteur)</span></div>
            
            <hr>
            
            <h2><i class="fas fa-bolt"></i> IMU & Capteurs</h2>
            <div class="data-point"><span>Acc√©l√©ration Totale</span><span id="imu-accel-total">0.00 m/s¬≤</span></div>
            <div class="data-point"><span>Acc√©l√©ration X/Y/Z (Body)</span><span id="imu-accel-xyz">0.00 / 0.00 / 0.00 m/s¬≤</span></div>
            <div class="data-point"><span>Vitesse Angulaire Z (Yaw)</span><span id="imu-gyro-z">0.00 ¬∞/s</span></div>
            <div class="data-point"><span>Bias Gyro Z</span><span id="bias-gyro-z">0.000 ¬∞/s</span></div>
            <div class="data-point"><span>Statut Capteur</span><span id="imu-status">Inactif</span></div>
            <div class="data-point"><span>Niveau Sonore (√âcholoc.)</span><span id="noise-level-current">N/A</span></div>
        </div>

        <div class="section grid-span-4">
            <h2><i class="fas fa-sun"></i> Astronomie Avanc√©e</h2>
            <div class="data-point"><span>Azimut Soleil (Mag.)</span><span id="sun-azimuth">N/A</span></div>
            <div class="data-point"><span>Altitude Soleil</span><span id="sun-altitude">N/A</span></div>
            <div class="data-point"><span>Temps du Cr√©puscule</span><span id="twilight-time">N/A</span></div>
        </div>
    </div>
    
    <script src="gnss-dashboard-full.js"></script>
    
</body>
    </html>
