<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNSS Advanced Dashboard (EKF & Biomim√©tisme)</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAo9T0oJ2R7x34y1X0fB7K+G9eQ7w6P92y224o3z9=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-2H01gH02M0F9Lp6HhM4g+C/d8+t4r94R95L2wX0/b2x8=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/suncalc@1.8.0/suncalc.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; color: #333; transition: background-color 0.3s, color 0.3s; }
        .dark-mode body { background-color: #1a1a2e; color: #e0e0e0; }
        header { background-color: #4CAF50; color: white; padding: 15px; text-align: center; }
        .container { display: flex; flex-wrap: wrap; max-width: 1400px; margin: 20px auto; padding: 0 10px; }
        section { background: white; padding: 20px; margin: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); flex: 1 1 300px; min-width: 300px; }
        .dark-mode section { background: #2c2c54; box-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        h2 { border-bottom: 2px solid #ccc; padding-bottom: 10px; margin-top: 0; color: #4CAF50; }
        .dark-mode h2 { border-bottom-color: #555; color: #66ff66; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .stat-item { padding: 5px 0; border-bottom: 1px dotted #eee; }
        .dark-mode .stat-item { border-bottom-color: #444; }
        .label { font-weight: bold; display: block; font-size: 0.9em; color: #666; }
        .dark-mode .label { color: #aaa; }
        .value { font-size: 1.1em; display: block; }
        #map-container { height: 400px; margin: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .controls { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
        .controls button, .controls select { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; }
        
        /* Minecraft Clock Visualization */
        #minecraft-clock { position: relative; width: 100px; height: 100px; margin: 20px auto; border: 4px solid gold; border-radius: 50%; overflow: hidden; background-color: #87ceeb; /* Jour */ }
        .dark-mode #minecraft-clock { background-color: #00008b; /* Nuit */ }
        #minecraft-clock::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%; background-color: #000; opacity: 0; transition: opacity 1s, background-color 1s; z-index: 1; }
        .sun-element, .moon-element { position: absolute; top: 50%; left: 50%; transform-origin: 0 0; font-size: 1.5em; width: 0; height: 0; margin-top: -8px; margin-left: -8px; transition: transform 0.1s; z-index: 2; }
    </style>

    <script src="gnss-dashboard-full.js" defer></script>
</head>
<body>
    <header>
        <h1>Tableau de Bord GNSS Avanc√© (EKF, ZVU Temp, Astro R√©el)</h1>
    </header>
    
    <div class="container">

        <section style="flex: 1 1 100%;">
            <h2>üõ†Ô∏è Contr√¥les & Statut Syst√®me</h2>
            <div class="controls">
                <button id="toggle-gps-btn">‚ñ∂Ô∏è MARCHE GPS</button>
                <select id="freq-select">
                    <option value="HIGH_FREQ">Haute Fr√©quence (Optimale)</option>
                    <option value="LOW_FREQ">Basse Fr√©quence (√âconomie)</option>
                </select>
                <button id="emergency-stop-btn">üõë Arr√™t d'urgence: INACTIF üü¢</button>
                <button id="reset-all-btn">üîÑ R√©initialiser Tout</button>
                <button id="nether-toggle-btn">Minecraft Nether Mode (1:8)</button>
                <button id="toggle-mode-btn">üåó Mode Nuit</button>
                
                <select id="environment-select">
                    <option value="NORMAL">Environnement Normal</option>
                    <option value="FOREST">For√™t/Feuillage</option>
                    <option value="CONCRETE">Urbain Dense (B√©ton)</option>
                    <option value="METAL">M√©tal/Structure R√©fl√©chissante</option>
                </select>
            </div>

            <div class="stat-grid">
                <div class="stat-item">
                    <span class="label">Statut GNSS / Mode</span>
                    <span id="underground-status" class="value">INIT...</span>
                </div>
                <div class="stat-item">
                    <span class="label">Pr√©cision GPS (Acc)</span>
                    <span id="gps-precision" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Pr√©cision EKF (R dyn)</span>
                    <span id="speed-error-perc" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Statut ZVU</span>
                    <span id="zvu-lock-status" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">ZVU Temps Verrouill√©</span>
                    <span id="zvu-lock-time" class="value">0.0 s</span>
                </div>
                <div class="stat-item">
                    <span class="label">Mode Nether</span>
                    <span id="mode-nether" class="value">D√âSACTIV√â (1:1)</span>
                </div>
            </div>
            <p>Override Pr√©cision (m): <input type="number" id="gps-accuracy-override" value="0" min="0" style="width: 80px;"></p>
        </section>

        <section>
            <h2>üöÄ Vitesse & Cin√©matique EKF</h2>
            <div class="stat-grid">
                <div class="stat-item">
                    <span class="label">Vitesse EKF Stable (km/h)</span>
                    <span id="speed-stable" class="value">0.00000 km/h</span>
                </div>
                <div class="stat-item">
                    <span class="label">Vitesse EKF (m/s | mm/s)</span>
                    <span id="speed-stable-ms" class="value">0.000 m/s | 0 mm/s</span>
                </div>
                <div class="stat-item">
                    <span class="label">Vitesse 3D Instantan√©e (km/h)</span>
                    <span id="speed-3d-inst" class="value">0.00000 km/h</span>
                </div>
                <div class="stat-item">
                    <span class="label">Vitesse Verticale (m/s)</span>
                    <span id="vertical-speed" class="value">0.00 m/s</span>
                </div>
                <div class="stat-item">
                    <span class="label">Distance Totale (km | m)</span>
                    <span id="distance-total-km" class="value">0.000 km | 0.00 m</span>
                </div>
                <div class="stat-item">
                    <span class="label">Temps en Mouvement</span>
                    <span id="time-moving" class="value">0.00 s</span>
                </div>
                <div class="stat-item">
                    <span class="label">Acc√©l√©ration Longitudinale</span>
                    <span id="accel-long" class="value">0.000 m/s¬≤</span>
                </div>
                <div class="stat-item">
                    <span class="label">Force G Longitudinale</span>
                    <span id="force-g-long" class="value">0.00 G</span>
                </div>
            </div>
            <button id="reset-all-btn" style="margin-top: 10px;">R√©initialiser Vitesse & Distance</button>
        </section>

        <section>
            <h2>üìç Localisation & IMU</h2>
            <div class="stat-grid">
                <div class="stat-item">
                    <span class="label">Latitude</span>
                    <span id="latitude" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Longitude</span>
                    <span id="longitude" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Altitude EKF (m)</span>
                    <span id="altitude-gps" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Acc√©l√©ration Verticale IMU</span>
                    <span id="accel-vertical-imu" class="value">0.000 m/s¬≤</span>
                </div>
                <div class="stat-item">
                    <span class="label">Force G Verticale IMU</span>
                    <span id="force-g-vertical" class="value">0.00 G</span>
                </div>
                <div class="stat-item">
                    <span class="label">Vitesse GPS Brute</span>
                    <span id="speed-raw-ms" class="value">N/A</span>
                </div>
            </div>
        </section>
        
        <section>
            <h2>ü™ê Astro-Navigation & Temps Solaire Vrai</h2>
            <div id="minecraft-clock">
                <span id="clock-status">TST (√âl√©vation: N/A¬∞)</span>
                <span id="time-minecraft">N/A</span>
            </div>
            <div class="stat-grid">
                <div class="stat-item">
                    <span class="label">Heure Locale (Synchro UTC)</span>
                    <span id="local-time" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Temps Solaire Vrai (TST)</span>
                    <span id="tst" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">D√©clinaison Solaire (Saisons R√©elles)</span>
                    <span id="sun-declination" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Angle Z√©nithal (90¬∞-Alt)</span>
                    <span id="zenith-angle" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">√âl√©vation Solaire Actuelle</span>
                    <span id="sun-elevation" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Phase Lunaire</span>
                    <span id="moon-phase-display" class="value">N/A</span>
                </div>
            </div>
        </section>

        <section>
            <h2>‚òÅÔ∏è M√©t√©o & Adaptation M√©tabolique</h2>
            <div class="stat-grid">
                <div class="stat-item">
                    <span class="label">Temp√©rature Air</span>
                    <span id="temp-air" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Pression Atmosph√©rique</span>
                    <span id="pressure" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Densit√© de l'Air (kg/m¬≥)</span>
                    <span id="air-density" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Force de Tra√Æn√©e (N)</span>
                    <span id="drag-force" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">√ânergie Cin√©tique (J)</span>
                    <span id="kinetic-energy" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Puissance M√©canique (W)</span>
                    <span id="mechanical-power" class="value">N/A</span>
                </div>
                <div class="stat-item">
                    <span class="label">Force de Coriolis (N)</span>
                    <span id="coriolis-force" class="value">N/A</span>
                </div>
            </div>
        </section>
    </div>

    <div id="map-container"></div>
    
</body>
    </html>
