<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNSS SpaceTime Dashboard ‚Ä¢ EKF Fusion</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIINfBIHUPz0M7mR1mZ9/3wPzSS6i8tD6U4=" 
          crossorigin=""/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" 
          integrity="sha512-Fo3rlrZj/k7ujTnHg4CfmjR7mQUFm94/Nfae/Y55JjNfX/YvD9eD+N6n7N2+3X5C6ZqT2C2F+V+h/lVj7T1/qA=" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />
          
    <style>
        /* --- Configuration G√©n√©rale --- */
        :root {
            --bg-light: #f4f7f6;
            --bg-dark: #121220;
            --panel-light: #ffffff;
            --panel-dark: #1e1e1e;
            --text-light: #333333;
            --text-dark: #f0f0f0;
            --accent-green: #4CAF50;
            --accent-red: #F44336;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-dark);
            color: var(--text-dark);
            transition: background-color 0.3s, color 0.3s;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1600px;
            margin: auto;
        }
        
        .panel {
            background-color: var(--panel-dark);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        h2 {
            font-size: 1.2em;
            color: var(--accent-green);
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
            margin-top: 0;
        }
        
        .data-point {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #333;
            font-size: 1em;
        }
        
        .data-point:last-child {
            border-bottom: none;
        }
        
        .data-point span:first-child {
            font-weight: 300;
        }
        
        .data-point span:last-child {
            font-weight: 700;
            color: var(--text-dark);
        }
        
        /* Contr√¥les et boutons */
        .controls, .reset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            background-color: #333;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 0.9em;
        }
        
        button:hover {
            background-color: #555;
        }
        
        .control-input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border-radius: 5px;
            border: 1px solid #555;
            background-color: #2a2a2a;
            color: var(--text-dark);
        }

        /* Vitesse sp√©cifique */
        .speed-display {
            font-size: 3em;
            font-weight: bold;
            color: var(--accent-green);
            text-align: center;
            margin: 10px 0;
        }

        /* Carte */
        #map-container {
            height: 350px;
            border-radius: 8px;
            margin-top: 10px;
            overflow: hidden;
            position: relative;
        }
        
        #gnss-map {
            width: 100%;
            height: 100%;
        }

        /* Animation Ciel */
        #sky-animation-container {
            position: relative;
            width: 100%;
            height: 150px;
            overflow: hidden;
            background: linear-gradient(to top, #001f3f, #0074d9); /* Ciel de nuit/cr√©puscule par d√©faut */
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .celestial-body {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            transition: transform 1s, background-color 0.5s;
        }

        #sun {
            background-color: #ffcc00;
            box-shadow: 0 0 10px #ffcc00;
        }

        #moon {
            background-color: #cccccc;
        }

        /* Le disque Minecraft et l'horizon */
        .minecraft-disk {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%; /* Largeur du conteneur */
            height: 100%; /* Hauteur du conteneur */
            overflow: hidden;
        }

        .horizon-line {
            position: absolute;
            top: 50%; /* L'horizon est au milieu du disque */
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #555;
            z-index: 10;
        }

        .biome-half {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 50%; /* Moiti√© inf√©rieure du disque */
            background-color: #228B22; /* Couleur par d√©faut du biome (For√™t/Terre) */
            transition: opacity 0.5s, background-color 0.5s;
            opacity: 1;
            z-index: 5;
        }
        
        /* Mode nuit */
        body.night-mode {
            background-color: #0a0a14;
        }
        body.night-mode .panel {
            background-color: #0c0c1c;
        }

    </style>
</head>
<body>

<div class="dashboard">

    <div class="panel">
        <h2><i class="fas fa-cog"></i> Contr√¥les & Syst√®me</h2>
        
        <div class="data-point"><span>Heure Locale (NTP)</span><span id="local-time">SYNCHRONISATION...</span></div>
        <div class="data-point"><span>Date Locale (UTC)</span><span id="date-display">N/A</span></div>
        <div class="data-point"><span>Temps √©coul√© (Session)</span><span id="time-session">0.00 s</span></div>
        <div class="data-point"><span>Temps de Mouvement</span><span id="time-moving">0.00 s</span></div>
        <div class="data-point"><span>Heure Minecraft</span><span id="minecraft-time">00:52</span></div>
        
        <div class="controls">
            <button id="toggle-gps"><i class="fas fa-pause"></i> PAUSE GPS</button>
            <button id="toggle-hf">Haute Fr√©quence</button>
            <button id="emergency-stop" class="status-green">üõë Arr√™t d'urgence: INACTIF üü¢</button>
            <button id="toggle-night-mode"><i class="fas fa-moon"></i> Mode Nuit</button>
            <button id="capture-data"><i class="fas fa-save"></i> CAPTURER LES DONN√âES</button>
        </div>

        <div class="reset-buttons">
            <button id="reset-dist"><i class="fas fa-redo"></i> R√©init. Dist.</button>
            <button id="reset-vmax"><i class="fas fa-redo"></i> R√©init. V-Max</button>
            <button id="reset-all"><i class="fas fa-power-off"></i> TOUT R√âINITIALISER</button>
        </div>
        
        <div class="data-point"><span>Forcer Pr√©cision GPS (m) [0=Auto]</span><input type="number" id="force-gps-acc" class="control-input" value="0"></div>

        <hr>

        <h3>Environnement (Filtre Kalman)</h3>
        <div class="data-point"><span>Bruit de Processus (Q)</span><span id="kalman-q">Normal (x1.0)</span></div>
        <div class="data-point"><span>Bruit de Mesure (R)</span><span id="kalman-r">Normal (x1.0)</span></div>
        <div class="data-point"><span>Masse de l'objet (kg)</span><span id="object-mass">70.000 kg</span></div>
        <div class="data-point"><span>Corps C√©leste (Gravit√©)</span><span id="celestial-body">Terre: 9.8067 m/s¬≤</span></div>
        <div class="data-point"><span>Rapport Dist. Centre-Terre</span><span id="distance-ratio">1.000 (Surface)</span></div>
        
    </div>

    <div class="panel">
        <h2><i class="fas fa-tachometer-alt"></i> Vitesse & Distance</h2>
        
        <div class="speed-display" id="speed-stable-kmh">--.-- km/h</div>
        
        <div class="data-point"><span>Vitesse Stable (m/s)</span><span id="speed-stable-ms">-- m/s</span></div>
        <div class="data-point"><span>Vitesse Stable (km/s)</span><span id="speed-stable-kms">-- km/s</span></div>
        
        <div class="data-point"><span>Vitesse 3D (Instantan√©e)</span><span id="speed-inst">-- km/h</span></div>
        <div class="data-point"><span>Vitesse Brute (m/s)</span><span id="speed-raw">-- m/s</span></div>

        <hr>

        <div class="data-point"><span>Vitesse Max (Session)</span><span id="speed-max">0.0 km/h</span></div>
        <div class="data-point"><span>Vitesse Moyenne (Mvt)</span><span id="speed-avg-mvt">0.0 km/h</span></div>
        <div class="data-point"><span>Vitesse Moyenne (Total)</span><span id="speed-avg-total">0.0 km/h</span></div>
        
        <hr>
        
        <h3>Relativit√© & Fluides</h3>
        <div class="data-point"><span>% Vitesse du Son</span><span id="perc-sound">0.00 %</span></div>
        <div class="data-point"><span>Nombre de Mach</span><span id="mach-number">0.0000</span></div>
        <div class="data-point"><span>% Vitesse Lumi√®re (c)</span><span id="perc-light">0.00e+0 %</span></div>
        <div class="data-point"><span>Facteur de Lorentz (Œ≥)</span><span id="lorentz-factor">1.0000</span></div>

        <hr>

        <h3>Distance (3D)</h3>
        <div class="data-point"><span>Distance Totale (3D)</span><span id="distance-total">0.000 km | 0.00 m</span></div>
        <div class="data-point"><span>Distance Max Visible (Horizon)</span><span id="distance-horizon">N/A</span></div>
        <div class="data-point"><span>Distance (s-lumi√®re)</span><span id="dist-slight">0.00e+00 s</span></div>
        <div class="data-point"><span>Distance (min-lumi√®re)</span><span id="dist-mlight">0.00e+00 min</span></div>
        <div class="data-point"><span>Distance (h-lumi√®re)</span><span id="dist-hlight">0.00e+00 h</span></div>
        <div class="data-point"><span>Distance (j-lumi√®re)</span><span id="dist-dlight">0.00e+00 j</span></div>
        <div class="data-point"><span>Distance (UA / al)</span><span id="dist-au-al">0.00e+00 UA | 0.00e+00 al</span></div>

    </div>

    <div class="panel" style="grid-column: span 1;">
        <h2><i class="fas fa-globe-americas"></i> Position & Astro</h2>
        
        <div id="sky-animation-container">
            <div class="minecraft-disk">
                <div class="biome-half"></div>
                <div class="horizon-line"></div>
                <div id="sun" class="celestial-body">‚òÄÔ∏è</div>
                <div id="moon" class="celestial-body">üåô</div>
            </div>
            <button id="toggle-xray" style="position: absolute; top: 10px; right: 10px; z-index: 20;">Rayons X</button>
        </div>
        
        <div class="data-point"><span>Nuit/Cr√©puscule</span><span id="day-night-status">üåô</span></div>
        <div class="data-point"><span>Latitude (EKF)</span><span id="latitude">N/A</span></div>
        <div class="data-point"><span>Longitude (EKF)</span><span id="longitude">N/A</span></div>
        <div class="data-point"><span>Altitude (EKF Corrig√©e)</span><span id="altitude-ekf">N/A</span></div>
        <div class="data-point"><span>Altitude G√©opotentielle</span><span id="altitude-geopo">N/A</span></div>
        <div class="data-point"><span>Cap (Direction, Magn√©to)</span><span id="heading">N/A</span></div>

        <hr>
        
        <h3>Syst√®mes Temporels</h3>
        <div class="data-point"><span>Date (Astro)</span><span id="date-astro">N/A</span></div>
        <div class="data-point"><span>Date Solaire Moyenne (MSD)</span><span id="date-solar-mean">N/A</span></div>
        <div class="data-point"><span>Date Solaire Vraie (TSD)</span><span id="date-solar-true">N/A</span></div>
        <div class="data-point"><span>Heure Solaire Vraie (TST)</span><span id="time-solar-true">N/A</span></div>
        <div class="data-point"><span>Heure Solaire Moyenne (MST)</span><span id="time-solar-mean">N/A</span></div>
        <div class="data-point"><span>Heure Lunaire</span><span id="time-lunar">N/A</span></div>
        <div class="data-point"><span>Midi Solaire Local (UTC)</span><span id="solar-noon-utc">N/A</span></div>
        <div class="data-point"><span>√âquation du Temps (EOT)</span><span id="eot">N/A</span></div>
        <div class="data-point"><span>Temps Sid√©ral Local Vrai</span><span id="lunar-time">N/A</span></div>

        <hr>

        <h3>√âph√©m√©rides Soleil/Lune</h3>
        <div class="data-point"><span>‚òÄÔ∏è Lever/Coucher (Locale)</span><span id="sun-rise-set-local">N/A / N/A</span></div>
        <div class="data-point"><span>üåô Lever/Coucher (Heure Lunaire)</span><span id="moon-rise-set-lunar">N/A / N/A</span></div>
        <div class="data-point"><span>Phase Lune</span><span id="moon-phase">N/A (N/A %)</span></div>
        <div class="data-point"><span>Lune √Çge (Jours)</span><span id="moon-age">N/A</span></div>
        <div class="data-point"><span>Lune Distance (km)</span><span id="moon-distance">N/A</span></div>
        <div class="data-point"><span>Soleil Distance (UA)</span><span id="sun-distance">N/A</span></div>
    </div>
    
    <div class="panel">
        <h2><i class="fas fa-map-marked-alt"></i> Carte GNSS / Globe Interactif</h2>
        <div id="map-container">
            <div id="gnss-map"></div>
            <p style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: red; background: rgba(0,0,0,0.7); padding: 5px;">Globe / Aurore Bor√©ale - Logique √† impl√©menter.</p>
        </div>
        <div class="data-point"><span>Pr√©cision GPS (Acc)</span><span id="gps-accuracy">N/A</span></div>
        <div class="data-point"><span>Zoom: Globe/M√©t√©o/Aurora</span><button id="toggle-globe-view">Zoom Globe</button></div>
    </div>
    
    <div class="panel">
        <h2><i class="fas fa-cloud"></i> M√©t√©o & Biophysique</h2>
        
        <div class="data-point"><span>Temp. Air (R√©elle)</span><span id="temp-air">18.0 ¬∞C</span></div>
        <div class="data-point"><span>Pression Atm. (Corrig√©e)</span><span id="pressure">1019.5 hPa</span></div>
        <div class="data-point"><span>Humidit√© Relative</span><span id="humidity">66 %</span></div>
        <div class="data-point"><span>Point de Ros√©e</span><span id="dew-point-data">13.0 ¬∞C</span></div>
        <div class="data-point"><span>Densit√© de l'Air (Corrig√©e)</span><span id="air-density">1.200 kg/m¬≥</span></div>
        <div class="data-point"><span>Vitesse du Son Locale (Corrig√©e)</span><span id="sound-speed">341.8 m/s</span></div>
        
        <hr>

        <h3>Conditions Externes</h3>
        <div class="data-point"><span>Vent / Rafales</span><span id="wind-data">24 km/h (SE) / 44 km/h</span></div>
        <div class="data-point"><span>Couverture Nuageuse</span><span id="cloud-cover">57 %</span></div>
        <div class="data-point"><span>Plafond Nuageux</span><span id="cloud-ceiling">‚â• 9100 m</span></div>
        <div class="data-point"><span>Visibilit√©</span><span id="visibility">16.0 km</span></div>
        <div class="data-point"><span>Indice UV / AccuLumen</span><span id="uv-acc">0.6 / 3 (Faible)</span></div>

        <hr>
        
        <h3>Compteurs (R√©els)</h3>
        <div class="data-point"><span>Compteur Sonore (dB) Max/Moy</span><span id="sound-meter">N/A / N/A</span></div>
        <div class="data-point"><span>Compteur Lumi√®re (Lux) Max/Moy</span><span id="light-meter">N/A / N/A</span></div>
        <div class="data-point"><span>Compteur Magn√©tique ($\mu$T) Max/Moy</span><span id="magnetic-meter">N/A / N/A</span></div>
        <div class="data-point"><span>Taux d'Oxyg√®ne ($\text{O}_2$)</span><span id="o2-rate">20.9 % vol</span></div>

    </div>

    <div class="panel">
        <h2><i class="fas fa-atom"></i> Physique Avanc√©e & Fluides</h2>
        
        <div class="data-point"><span>Temps Dilation (Vitesse)</span><span id="time-dilation-v">0.00 ns/j</span></div>
        <div class="data-point"><span>Temps Dilation (Gravit√©)</span><span id="time-dilation-g">0.00 ns/j</span></div>
        <div class="data-point"><span>√ânergie Relativiste (E)</span><span id="relativistic-e">N/A</span></div>
        <div class="data-point"><span>√ânergie de Masse au Repos ($\text{E}_0$)</span><span id="mass-energy">N/A</span></div>
        <div class="data-point"><span>Rayon de Schwarzschild ($\text{R}_s$)</span><span id="schwarzschild-radius">N/A</span></div>
        
        <hr>
        
        <div class="data-point"><span>Pression Dynamique (q)</span><span id="dynamic-pressure">0.00 Pa</span></div>
        <div class="data-point"><span>Force de Tra√Æn√©e</span><span id="drag-force">0.00 N</span></div>
        <div class="data-point"><span>Pression de Radiation</span><span id="radiation-pressure">N/A</span></div>
        <div class="data-point"><span>Force de Coriolis</span><span id="coriolis-force">0.00 N</span></div>
        <div class="data-point"><span>Gravit√© Locale (g)</span><span id="gravity-local">N/A</span></div>
        <div class="data-point"><span>Acc√©l√©ration Long.</span><span id="accel-long">N/A</span></div>
        <div class="data-point"><span>Quantit√© de Mouvement</span><span id="momentum">N/A</span></div>
        <div class="data-point"><span>Nombre de Reynolds</span><span id="reynolds-number">N/A</span></div>

    </div>

    <div class="panel">
        <h2><i class="fas fa-cogs"></i> IMU (Acc√©l√©rom√®tre) & Debug</h2>
        
        <div class="data-point"><span>Acc√©l√©ration X</span><span id="accel-x">0.10 m/s¬≤</span></div>
        <div class="data-point"><span>Acc√©l√©ration Y</span><span id="accel-y">0.00 m/s¬≤</span></div>
        <div class="data-point"><span>Acc√©l√©ration Z</span><span id="accel-z">0.10 m/s¬≤</span></div>
        <div class="data-point"><span>Statut Capteur (IMU)</span><span id="imu-status">Actif</span></div>

        <hr>
        
        <h3>Filtre EKF & Debug</h3>
        <div class="data-point"><span>Incertitude Vitesse (P)</span><span id="kalman-uncert">N/A</span></div>
        <div class="data-point"><span>Incertitude Alt. ($\sigma$)</span><span id="alt-uncertainty">N/A</span></div> 
        <div class="data-point"><span>Bruit Mesure Vitesse (R)</span><span id="speed-error-perc">N/A</span></div>
        <div class="data-point"><span>Bande Passante (Nyquist)</span><span id="nyquist-frequency">N/A</span></div> 
        <div class="data-point"><span>Statut GPS & EKF</span><span id="gps-status-dr">Actif</span></div>
        <div class="data-point"><span>Forcer Pr√©cision GPS</span><span id="force-gps-output">0.000000 m</span></div>

        <p class="small-note">La Vitesse microscopique est am√©lior√©e par l'IMU (ZUPT/EKF) quand le GPS est faible/perdu.</p>
    </div>

</div> <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20n6sB18x8T+eK4jM+q5/1/rF8l/sE5O8h/O+A9jS44=" crossorigin=""></script>
<script src="gnss-dashboard-full.js"></script>

</body>
    </html>
