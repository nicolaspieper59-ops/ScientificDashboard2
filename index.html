<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNSS & Physique Dashboard</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoASSHd+UeWbYtT8xedbFhC5J3sNqR0fC3V6X5I="
        crossorigin=""/>
    
    <style>
        body { font-family: sans-serif; background-color: #333; color: #fff; margin: 20px; }
        .dashboard-section { margin-bottom: 20px; padding: 15px; border: 1px solid #555; border-radius: 8px; }
        .data-label { font-weight: bold; margin-right: 10px; }
        #map-container { height: 200px; width: 100%; margin-top: 10px; }
        
        /* Styles pour l'Horloge Astronomique (Modèle Stellarium) */
        #astro-display-container {
            width: 200px; /* Doit correspondre à 2 * MAX_RADIUS_PX dans JS */
            height: 200px; /* Doit correspondre à 2 * MAX_RADIUS_PX dans JS */
            border-radius: 50%;
            position: relative; /* Point de référence pour les astres */
            margin: 0 auto;
            border: 5px solid #ffc107; /* Cadre Jaune */
            overflow: hidden; /* Pour cacher les astres sous l'horizon */
        }
        #sky-display {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 0;
            background-color: #000; /* Couleur initiale du ciel (sera changé par JS) */
        }
        
        /* Styles pour le Soleil et la Lune (positionnés via JS.transform) */
        .astro-symbol {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            transform: translate(-50%, -50%); /* Centrer l'élément sur le point X,Y */
            z-index: 10;
        }
        #sun-element { background-color: yellow; }
        #moon-element { background-color: white; width: 8px; height: 8px; }
        
        /* Indicateurs cardinaux pour le réalisme (optionnel, à superposer sur astro-display-container) */
        #astro-display-container::before {
            content: 'N'; position: absolute; top: 0px; left: 50%; transform: translateX(-50%); color: #fff; z-index: 20;
        }
        #astro-display-container::after {
            content: 'S'; position: absolute; bottom: 0px; left: 50%; transform: translateX(-50%); color: #fff; z-index: 20;
        }
        /* Ajoutez E et O avec une position relative ou d'autres pseudo-éléments */
        
        .control-btn { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; color: #fff; }
        #toggle-gps-btn { background-color: #28a745; }
        #emergency-stop-btn { background-color: #dc3545; }
        #reset-dist-btn, #reset-max-btn { background-color: #007bff; }
    </style>
</head>
<body>

    <h1>•0•0„1‚5 Contrôles & Système</h1>
    <div class="dashboard-section">
        <p><span class="data-label">Heure Locale (NTP):</span> <span id="local-time">N/A</span></p>
        <p><span class="data-label">Date Locale:</span> <span id="date-display">N/A</span></p>
        <p><span class="data-label">Temps écoulé (Session):</span> <span id="time-elapsed">N/A</span></p>
        <p><span class="data-label">Temps de Mouvement:</span> <span id="time-moving">N/A</span></p>
        <p><span class="data-label">Heure Solaire Vraie (TST):</span> <span id="tst">00:00:00</span></p>
        <p><span class="data-label">Corps Céleste Actuel:</span> <span id="celestial-body-display">Terre</span></p>
        <p><span class="data-label">Gravité Locale (g):</span> <span id="gravity-local">9.81967 m/s²</span></p>
        
        <select id="celestial-body-select" onchange="updateCelestialBody(this.value)">
            <option value="EARTH">Terre</option>
            <option value="MOON">Lune</option>
            <option value="MARS">Mars</option>
        </select>
        
        <p>
            <button id="toggle-gps-btn" class="control-btn">7œ4„1‚5 ARRÊT GPS</button>
            <button id="emergency-stop-btn" class="control-btn">•0“5 Arrêt d'urgence: INACTIF •0 4</button>
        </p>
    </div>

    <hr>
    
    <h2>•0‹4 Vitesse & Distance</h2>
    <div class="dashboard-section">
        <p><span class="data-label">Vitesse Stable (EKF):</span> <span id="speed-stable">0.0000 km/h</span></p>
        <p><span class="data-label">Vitesse 3D (Inst.):</span> <span id="speed-3d-inst">0.0000 km/h</span></p>
        <p><span class="data-label">Vitesse Max (Session):</span> <span id="speed-max">0.0000 km/h</span></p>
        <p><span class="data-label">Distance Totale (3D):</span> <span id="distance-total-km">0.000 km | 0.00 m</span></p>
        <p>
            <button id="reset-max-btn" class="control-btn">”9ã4 Vitesse Max</button>
            <button id="reset-dist-btn" class="control-btn">7¿8 TOUT RÉINITIALISER</button>
        </p>
    </div>
    
    <hr>

    <h2>•0–6„1‚5 Vue brute GPS & Physique</h2>
    <div class="dashboard-section">
        <p><span class="data-label">Latitude Brute:</span> <span id="lat-raw">N/A</span></p>
        <p><span class="data-label">Longitude Brute:</span> <span id="lon-raw">N/A</span></p>
        <p><span class="data-label">Altitude GPS:</span> <span id="alt-gps">N/A</span></p>
        <p><span class="data-label">Précision GPS (EPE):</span> <span id="acc-gps">N/A</span></p>
        <p><span class="data-label">Facteur Kalman Environnement:</span>
            <select id="environment-select">
                <option value="NORMAL">Normal (x1.0)</option>
                <option value="FOREST">Forêt (x1.5)</option>
                <option value="METAL">Métal (x2.5)</option>
                <option value="CONCRETE">Béton (x3.0)</option>
            </select>
        </p>
    </div>
    
    <hr>

    <h2>”9Ù9 Dynamique du Véhicule & Forces</h2>
    <div class="dashboard-section">
        <p><span class="data-label">Accel. Longitudinale (Hybride):</span> <span id="accel-long">0.000 m/s²</span></p>
        <p><span class="data-label">Force G (Longitudinale):</span> <span id="force-g-long">0.00 G | Max: 0.00 G</span></p>
        <p><span class="data-label">Accel. Verticale (IMU):</span> <span id="accel-vertical-imu">0.000 m/s²</span></p>
        <p><span class="data-label">Force G (Verticale):</span> <span id="force-g-vertical">1.00 G</span></p>
    </div>
    
    <hr>
    
    <h2>”9³1„1‚5 Météo & Capteurs</h2>
    <div class="dashboard-section">
        <p><span class="data-label">Température Air:</span> <span id="temp-air">API Requis</span></p>
        <p><span class="data-label">Pression Atmosphérique:</span> <span id="pressure">API Requis</span></p>
        <p><span class="data-label">Humidité Relative:</span> <span id="humidity">API Requis</span></p>
        <p><span class="data-label">Vitesse du Vent (m/s):</span> <span id="wind-speed-ms">API Requis</span></p>
    </div>

    <hr>

    <h2>8¬2 Soleil & Lune (Projection Zénithale)</h2>
    <div class="dashboard-section">
        <div id="astro-display-container">
            <div id="sky-display">
                <div id="sun-element" class="astro-symbol"></div>
                <div id="moon-element" class="astro-symbol"></div>
            </div>
        </div>
        <p style="margin-top: 15px;"><span class="data-label">Élévation du Soleil:</span> <span id="sun-elevation">-- °</span></p>
        <p><span class="data-label">Midi Solaire Local:</span> <span id="noon-solar">N/A</span></p>
        <p><span class="data-label">Durée du Jour Solaire:</span> <span id="day-duration">N/A</span></p>
        <p><span class="data-label">Lune & Phases:</span> <span id="moon-phase-display">N/A</span></p>
    </div>
    
    <hr>

    <h2>”9ü0„1‚5 Carte GNSS</h2>
    <div class="dashboard-section">
        <div id="map-container">Initialisation de la carte...</div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20n6B+A8ay8YlFk1T2Wf82f2fQJ/1y5c5v+t6zNqE2S="
        crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/suncalc@1.9.0/suncalc.min.js"></script>

    <script src="gnss-dashboard-full.js"></script>
</body>
    </html>
