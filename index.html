<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNSS Kalman Dashboard V9</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/suncalc@1.8.0/suncalc.min.js"></script>
</head>
<body class="dark-mode">

    <header>
        <h1>GNSS/IMU Kalman Dashboard V9</h1>
        <div class="header-controls">
            <button id="toggle-gps-btn" class="control-button green">‚ñ∂Ô∏è MARCHE GPS</button>
            <button id="emergency-stop-btn" class="control-button red">üõë Arr√™t d'urgence: INACTIF üü¢</button>
            <button id="toggle-mode-btn" class="control-button" class="active">‚òÄÔ∏è Mode Jour</button>
        </div>
    </header>

    <main>
        <div class="dashboard-grid">

            <div class="stat-group controls">
                <h3>üõ†Ô∏è Contr√¥les & Statut</h3>
                <table>
                    <tr>
                        <td class="label">Fr√©quence GPS</td>
                        <td class="value">
                            <select id="freq-select">
                                <option value="HIGH_FREQ">Haute (Pr√©cis)</option>
                                <option value="LOW_FREQ">Basse (√âconome)</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="label">Environnement</td>
                        <td class="value">
                            <select id="environment-select">
                                <option value="OPEN">Ouvert (Rue/Mer)</option>
                                <option value="FOREST">For√™t/Arbres</option>
                                <option value="CONCRETE">B√©ton/Ville</option>
                                <option value="METAL">M√©tro/Ascenseur</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="label">Mode Nether (MC)</td>
                        <td class="value" id="mode-nether">D√âSACTIV√â (1:1) <button id="nether-toggle-btn">Toggle</button></td>
                    </tr>
                    <tr>
                        <td class="label">Masse du corps/v√©hicule (kg)</td>
                        <td class="value"><input type="number" id="mass-input" value="70"> kg</td>
                    </tr>
                </table>
                <div class="button-row">
                    <button id="reset-dist-btn">üîÑ Reset Distance</button>
                    <button id="reset-max-btn">üîÑ Reset Max</button>
                </div>
            </div>

            <div class="stat-group speed-accel">
                <h3>‚ö° Vitesse & Acc√©l√©ration (EKF Filtr√©)</h3>
                <table>
                    <tr>
                        <td class="label">Vitesse Stable (km/h)</td>
                        <td class="value large" id="speed-stable">0.0000 km/h</td>
                    </tr>
                    <tr>
                        <td class="label">Vitesse Stable (m/s)</td>
                        <td class="value" id="speed-stable-ms">0.000 m/s</td>
                    </tr>
                    <tr>
                        <td class="label">Vitesse Max Atteinte</td>
                        <td class="value" id="speed-max">0.0000 km/h</td>
                    </tr>
                    <tr>
                        <td class="label">Acc√©l√©ration Longitudinale</td>
                        <td class="value" id="accel-long">0.000 m/s ¬≤</td>
                    </tr>
                    <tr>
                        <td class="label">Force G Longitudinale</td>
                        <td class="value" id="force-g-long">0.00 G | Max: 0.00 G</td>
                    </tr>
                    <tr>
                        <td class="label">Vitesse Verticale (Altitude)</td>
                        <td class="value" id="vertical-speed">0.00 m/s</td>
                    </tr>
                </table>
            </div>

            <div class="stat-group distance-energy">
                <h3>üìè Distance & √ânergie</h3>
                <table>
                    <tr>
                        <td class="label">Distance Totale Parcourue</td>
                        <td class="value large" id="distance-total-km">0.000 km | 0.00 m</td>
                    </tr>
                    <tr>
                        <td class="label">Temps de Mouvement Total</td>
                        <td class="value" id="time-moving">0.00 s</td>
                    </tr>
                    <tr>
                        <td class="label">√ânergie Cin√©tique (Ek)</td>
                        <td class="value" id="kinetic-energy">0.00 J</td>
                    </tr>
                    <tr>
                        <td class="label">Puissance M√©canique</td>
                        <td class="value" id="mechanical-power">0.00 W</td>
                    </tr>
                </table>
            </div>

            <div class="stat-group position-data">
                <h3>üìç Position & Pr√©cision GPS</h3>
                <table>
                    <tr>
                        <td class="label">Latitude</td>
                        <td class="value" id="latitude">0.000000</td>
                    </tr>
                    <tr>
                        <td class="label">Longitude</td>
                        <td class="value" id="longitude">0.000000</td>
                    </tr>
                    <tr>
                        <td class="label">Altitude GPS</td>
                        <td class="value" id="altitude-gps">N/A</td>
                    </tr>
                    <tr>
                        <td class="label">Pr√©cision Horizontale (HPE)</td>
                        <td class="value" id="gps-precision">N/A</td>
                    </tr>
                    <tr>
                        <td class="label">Statut Souterrain (> -50m)</td>
                        <td class="value" id="underground-status">Non</td>
                    </tr>
                </table>
            </div>
            
            <div class="stat-group">
                <h3>üß≠ Capteurs de Mouvement & Cap</h3>
                <table>
                    <tr>
                        <td class="label">Cap Boussole/IMU (Azimut)</td>
                        <td class="value" id="imu-heading">0.0 ¬∞</td>
                    </tr>
                    <tr>
                        <td class="label">Acc√©l√©ration Lin√©aire (Brute)</td>
                        <td class="value" id="accel-imu-raw">0.000 m/s¬≤</td>
                    </tr>
                    <tr>
                        <td class="label">Acc√©l√©ration Verticale Corrig√©e</td>
                        <td class="value" id="accel-vertical-imu">0.000 m/s¬≤</td>
                    </tr>
                    <tr>
                        <td class="label">Force G Verticale (Brute)</td>
                        <td class="value" id="force-g-vertical">0.00 G</td>
                    </tr>
                </table>
            </div>

            <div class="stat-group kalman-stats">
                <h3>üßÆ Filtre de Kalman (EKF)</h3>
                <table>
                    <tr>
                        <td class="label">Incertitude EKF (P)</td>
                        <td class="value" id="kalman-uncert">0.00000 m¬≤</td>
                    </tr>
                    <tr>
                        <td class="label">Incertitude Mesure GPS (R)</td>
                        <td class="value" id="kalman-r-dyn">0.00000 m¬≤</td>
                    </tr>
                    <tr>
                        <td class="label">Vitesse % C (Lumi√®re)</td>
                        <td class="value" id="perc-speed-c">0.00e+00%</td>
                    </tr>
                    <tr>
                        <td class="label">Vitesse % Mach 1 (Son)</td>
                        <td class="value" id="perc-speed-sound">0.00%</td>
                    </tr>
                </table>
            </div>

            <div class="stat-group astro-weather">
                <h3>ü™ê Temps & M√©t√©o</h3>
                <table>
                    <tr>
                        <td class="label">Heure Locale / Date</td>
                        <td class="value" id="local-time">--:--:--</td>
                    </tr>
                    <tr>
                        <td class="label">Heure Solaire Vraie (TST)</td>
                        <td class="value" id="tst">--:--:--</td>
                    </tr>
                    <tr>
                        <td class="label">Temps √©coul√© Total</td>
                        <td class="value" id="time-elapsed">0.00 s</td>
                    </tr>
                    <tr>
                        <td class="label">Temp√©rature de l'Air</td>
                        <td class="value" id="temp-air">N/A</td>
                    </tr>
                    <tr>
                        <td class="label">Pression Atmosph√©rique</td>
                        <td class="value" id="pressure">N/A</td>
                    </tr>
                    <tr>
                        <td class="label">Vitesse du Vent</td>
                        <td class="value" id="wind-speed-ms">N/A</td>
                    </tr>
                </table>
                <div class="compass-display">
                    <div id="sun-element" class="celestial-body sun">üåû</div>
                    <div id="moon-element" class="celestial-body moon">üåô</div>
                    <div id="moon-phase-display" class="moon-phase">Phase: 0%</div>
                </div>
            </div>

            <div class="stat-group map-container">
                <h3>üó∫Ô∏è Carte de Position (Leaflet)</h3>
                <div id="map-container"></div>
            </div>

        </div>
    </main>

    <script src="gnss-dashboard-full.js"></script>
</body>
                            </html>
