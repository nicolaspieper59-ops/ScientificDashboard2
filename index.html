<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNSS SpaceTime Dashboard ‚Ä¢0‚Äπ4 (FINAL)</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIINfBIHUPz0M7mR1mZ9/3wPzSS6i8tD6U4=" 
          crossorigin=""/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" 
          integrity="sha512-Fo3rlrZj/k7ujTnHg4CfmjR7mQUFm94/Nfae/Y55JjNfX/YvD9eD+N6n7N2+3X5C6ZqT2C2F+V+h/lVj7T1/qA=" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />
          
    <style>
        /* CSS GENERAL */
        body { font-family: 'Arial', sans-serif; margin: 0; padding: 20px; background-color: #333; color: #fff; transition: background-color 0.8s, color 0.8s; }
        .dashboard-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .dashboard-section { padding: 15px; border: 1px solid #555; border-radius: 8px; }
        .data-point { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; }
        .data-point span:first-child { font-weight: bold; }
        #map-container { height: 200px; width: 100%; margin-top: 10px; }
        .control-btn { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; color: #fff; margin-right: 10px; }
        #toggle-gps-btn { background-color: #28a745; }
        #emergency-stop-btn { background-color: #dc3545; }
        #emergency-stop-btn.active { background-color: #f8d7da; color: #721c24; }
        
        /* COULEUR DU CIEL DYNAMIQUE (appliqu√©e √† body) */
        .sky-day { background-color: #6a9fec; color: #333; }
        .sky-sunset { background-color: #ff9955; color: #000; }
        .sky-night-light { background-color: #191970; color: #fff; }
        .sky-night { background-color: #000000; color: #ccc; }

        /* ASTRO Z√âNITHAL (STELLARIUM) */
        #astro-display-container {
            width: 90px; height: 90px; /* 2 * MAX_RADIUS_PX = 90 */
            border-radius: 50%;
            position: relative; 
            margin: 10px auto;
            border: 5px solid #ffc107; /* Cadre Jaune */
            overflow: hidden; 
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }
        #sky-display {
            width: 100%; height: 100%; border-radius: 50%;
            position: absolute; top: 0; left: 0;
        }
        .astro-symbol {
            position: absolute; width: 8px; height: 8px; border-radius: 50%;
            transform: translate(-50%, -50%); 
            z-index: 10;
        }
        #sun-element { background-color: yellow; }
        #moon-element { background-color: white; width: 6px; height: 6px; }

        /* Indicateurs cardinaux (visuels) */
        #astro-display-container::before, #astro-display-container::after {
            position: absolute; font-size: 10px; font-weight: bold; color: #fff; z-index: 20;
        }
        #astro-display-container::before { content: 'N'; top: -15px; left: 50%; transform: translateX(-50%); }
        #astro-display-container::after { content: 'S'; bottom: -15px; left: 50%; transform: translateX(-50%); }
        #astro-display-container .E, #astro-display-container .O { position: absolute; font-size: 10px; font-weight: bold; color: #fff; z-index: 20; }
        #astro-display-container .E { top: 50%; right: -15px; transform: translateY(-50%); content: 'E'; }
        #astro-display-container .O { top: 50%; left: -15px; transform: translateY(-50%); content: 'O'; }
        
    </style>
</head>
<body>

<div class="dashboard-container">

    <div class="dashboard-section">
        <h2>‚Ä¢0‚Ä¢0‚Äû1‚Äö5 Syst√®me & Contr√¥les</h2>
        <div class="data-point"><span>Heure Locale (UTC Synchrone)</span><span id="local-time">N/A</span></div>
        <div class="data-point"><span>Heure Solaire Vraie (TST)</span><span id="tst">00:00:00</span></div>
        <div class="data-point"><span>Temps √âcoul√© (Session)</span><span id="time-elapsed">N/A</span></div>
        <hr>
        <button id="toggle-gps-btn" class="control-btn">‚ñ∂Ô∏è MARCHE GPS</button>
        <button id="emergency-stop-btn" class="control-btn">üõë Arr√™t d'urgence: INACTIF üü¢</button>
        <div style="margin-top: 10px;">
            <label for="freq-select">Mode GPS/EKF :</label>
            <select id="freq-select">
                <option value="HIGH_FREQ">Haute Fr√©quence (IMU Fusion)</option>
                <option value="LOW_FREQ">Basse Fr√©quence (√âconomie)</option>
            </select>
        </div>
    </div>

    <div class="dashboard-section">
        <h2>‚Ä¢0‚Äπ4 Vitesse & Acc√©l√©ration</h2>
        <div class="data-point"><span>Vitesse Stable (EKF)</span><span id="speed-stable">0.00000 km/h</span></div>
        <div class="data-point"><span>Vitesse 3D Brute (Inst.)</span><span id="speed-3d-inst">0.00000 km/h</span></div>
        <div class="data-point"><span>Vitesse Verticale (Filtr√©e)</span><span id="vertical-speed">0.00 m/s</span></div>
        <div class="data-point"><span>Accel. Longitudinale (Hybride)</span><span id="accel-long">0.000 m/s¬≤</span></div>
        <div class="data-point"><span>Force G (Longitudinale)</span><span id="force-g-long">0.00 G</span></div>
        <hr>
        <div class="data-point"><span>Distance Totale (3D)</span><span id="distance-total-km">0.000 km | 0.00 m</span></div>
        <div class="data-point"><span>Temps de Mouvement</span><span id="time-moving">0.00 s</span></div>
        <button id="reset-dist-btn" class="control-btn" style="background-color: #007bff;">‚Ü∫ R√©init. Distance</button>
        <button id="reset-max-btn" class="control-btn" style="background-color: #007bff;">‚Ü∫ R√©init. Max</button>
    </div>
    
    <div class="dashboard-section">
        <h2>‚Äù9√ô9 IMU & Niveau √† Bulle</h2>
        <div class="data-point"><span>Tangage (Pitch - X)</span><span id="pitch-angle">0.0 ¬∞</span></div>
        <div class="data-point"><span>Roulis (Roll - Y)</span><span id="roll-angle">0.0 ¬∞</span></div>
        <div class="data-point"><span>Accel. Verticale (IMU Lin√©aire)</span><span id="accel-vertical-imu">0.000 m/s¬≤</span></div>
        <div class="data-point"><span>Force G (Verticale Corrig√©e)</span><span id="force-g-vertical">0.00 G</span></div>
        <hr>
        <h2>8¬¨2 Horloge Astronomique</h2>
        <div id="astro-display-container">
            <div id="sky-display">
                <div id="sun-element" class="astro-symbol"></div>
                <div id="moon-element" class="astro-symbol"></div>
                <span class="E">E</span><span class="O">O</span> </div>
        </div>
        <div class="data-point"><span>√âl√©vation du Soleil</span><span id="sun-elevation">-- ¬∞</span></div>
        <div class="data-point"><span>Phase Lunaire</span><span id="moon-phase-display">N/A</span></div>
    </div>
    
    <div class="dashboard-section">
        <h2>‚Äù9√º0‚Äû1‚Äö5 Coordonn√©es & Pr√©cision</h2>
        <div class="data-point"><span>Latitude Filrtr√©e</span><span id="latitude">N/A</span></div>
        <div class="data-point"><span>Longitude Filtr√©e</span><span id="longitude">N/A</span></div>
        <div class="data-point"><span>Altitude (Kalman)</span><span id="altitude-gps">N/A</span></div>
        <div class="data-point"><span>Pr√©cision GPS (EPE)</span><span id="gps-precision">N/A</span></div>
        <div class="data-point"><span>Cap (Heading)</span><span id="heading-display">N/A</span></div>
        <hr>
        <h2>‚Äù9¬≥1‚Äû1‚Äö5 M√©t√©o (API)</h2>
        <div class="data-point"><span>Temp√©rature Air</span><span id="temp-air">API Requis</span></div>
        <div class="data-point"><span>Pression Atmosph√©rique</span><span id="pressure">API Requis</span></div>
        <div class="data-point"><span>Humidit√© Relative</span><span id="humidity">API Requis</span></div>
        <div class="data-point"><span>Vitesse du Vent</span><span id="wind-speed-ms">API Requis</span></div>
    </div>
    
    <div class="dashboard-section" style="grid-column: 1 / -1;">
        <h2>üó∫Ô∏è Carte GNSS</h2>
        <div id="map-container">Initialisation de la carte...</div>
    </div>

</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20n6B+A8ay8YlFk1T2Wf82f2fQJ/1y5c5v+t6zNqE2S="
        crossorigin=""></script>
<script src="https://cdn.jsdelivr.net/npm/suncalc@1.9.0/suncalc.min.js"></script>

<script src="gnss-dashboard-full.js"></script>
</body>
    </html>
